[Rainmeter]
Update=1000
AccurateText=1
DynamicWindowSize=1

[Metadata]
Name=Binance ETHUSDT Order Tracker
Author=Jaideep Mahay
Version=1
License=GNU GPLv3
Information=Live ETH Buy/Sell ratio from Binance API.

[Variables]
; Original Binance Colors
ColorBuy=46,204,113
ColorSell=231,76,60
Width=240

; --- MEASURES ---

[MeasureBinanceJSON]
Measure=WebParser
Url=https://fapi.binance.com/fapi/v1/depth?symbol=ETHUSDT&limit=5
RegExp=(?siU)"bids":\[\["(.*)".*"(.*)".*"asks":\[\["(.*)".*"(.*)"
UpdateRate=3

[MeasureBuyQty]
Measure=WebParser
URL=[MeasureBinanceJSON]
StringIndex=2

[MeasureSellQty]
Measure=WebParser
URL=[MeasureBinanceJSON]
StringIndex=4

[MeasureTotal]
Measure=Calc
Formula=(MeasureBuyQty + MeasureSellQty)

[MeasureBuyPercent]
Measure=Calc
Formula=(MeasureBuyQty / (MeasureTotal + 0.00001)) * 100
; The Bar meter requires these Min/Max values to know how to fill the bar
MinValue=0
MaxValue=100

; --- NEW MEASURE FOR SELL CALCULATION ---
[MeasureSellPercent]
Measure=Calc
Formula=(100 - MeasureBuyPercent)

; --- VISUALS ---

[Background]
Meter=Shape
Shape=Rectangle 0,0,(#Width#+40),120,5 | Fill Color 30,30,30,220 | StrokeWidth 2 | Stroke Color 120,120,120,255

[Title]
Meter=String
Text=Binance ETHUSDT (Live)
X=(#Width#/2 + 20)
Y=15
FontColor=255,255,255
FontSize=11
StringAlign=Center
AntiAlias=1

[LabelBuy]
Meter=String
MeasureName=MeasureBuyPercent
Text=Buy: %1%
X=20
Y=45
FontColor=#ColorBuy#
FontSize=10
AntiAlias=1
NumOfDecimals=2

; --- FIXED LABEL SELL ---
[LabelSell]
Meter=String
MeasureName=MeasureSellPercent
Text=Sell: %1%
X=(#Width#+20)
Y=45
FontColor=#ColorSell#
FontSize=10
StringAlign=Right
AntiAlias=1
NumOfDecimals=2

; --- THE DYNAMIC BAR ---

; 1. This draws the RED part as the base
[BarSellBase]
Meter=Shape
X=20
Y=70
Shape=Rectangle 0,0,#Width#,25,2 | Fill Color #ColorSell# | Stroke Color 60,60,60

; 2. This draws the GREEN part on top, filling only the Buy percentage
[BarBuy]
Meter=Bar
MeasureName=MeasureBuyPercent
X=20
Y=70
W=#Width#
H=25
BarColor=#ColorBuy#
BarOrientation=Horizontal

; 3. Text Labels inside the bar
[BLabel]
Meter=String
Text=B
X=25
Y=74
FontColor=255,255,255,220
FontSize=9
FontWeight=700
AntiAlias=1

[SLabel]
Meter=String
Text=S
X=(#Width#+15)
Y=74
FontColor=255,255,255,220
FontSize=9
FontWeight=700
StringAlign=Right
AntiAlias=1